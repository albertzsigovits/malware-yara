rule Ransomware_Kangaroo_Strings : windows malware ransomware kangaroo {
    meta:
        author = "albertzsigovits"
        created_date = "2023-02-13"
        last_updated_date = ""
        version = "0"
        filetype = "pe"
        threat = "Ransomware.Kangaroo.A"
        reference = "https://bazaar.abuse.ch/browse/tag/kangaroo/"
        sha256 = "289780ac1b2d1ba4250cad5bc29d351de3fd363897f1ec64be083c096f0cf495"
        sha256 = "95edeef1ce88d91a455ace0eacf63c174814610c614002ed7dfa38e836eebdde"
        sha256 = "2b3865a354159aa3050788a81395fa7aab1d99765f0d87ac57823214cdbd6e4c"
        sha256 = "ac1ace0a239f5d8a08555181f5353c60cc0086241c6929f3b02c47f0ebc8a3f2"
        sha256 = "5e08e6203f8669f85404560412d0e4f79dd38098b7aa2bb4ac7c08c791320d1a"
        sha256 = "e690f3be09edcf2cb8eaf63b00347ba3a270dde857d70d5705734012a1b8c3e5"
	strings:
        $str1 = "Contact_Data_Recovery.txt" ascii wide
        $str2 = "%SystemRoot%\\System32\\wbem\\wmic.exe" ascii wide
        $str3 = "process call create" ascii wide
        $str4 = "vssadmin delete shadows /all /quiet" ascii wide
        $str5 = "                    Encryption key:" ascii wide
        $str6 = "                        Unique ID:" ascii wide

        $notea1 = "All your data has been encrypted." ascii wide
        $notea2 = "Contact by Email for data recovery." ascii wide
        $notea3 = "WARNING: If you don't contact in 72 hours, contact from a different email provider" ascii wide

        $noteb1 = "Attention!!! All the files in your PC were Encrypted!" ascii wide
        $noteb2 = "Contact by Email for DATA recovery." ascii wide
        $noteb3 = "Then, we'll provide Data Decryption Software to you." ascii wide
        $noteb4 = "WARNING: If you don't contact in 72 hours, then all DATA will be damaged unrecoverably!!!" ascii wide

        $email1 = "Email : restore_2019@mail.ru" ascii wide
        $email2 = "Email : dataforward@bk.ru" ascii wide
        $mutex = "Local\\Kangaroo_Ransomware" ascii wide
	condition:
        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550
        and ( 
                4 of ($str*)
                or
                all of ($notea*)
                or
                all of ($noteb*)
                or
                $email1
                or
                $email2
                or
                $mutex
        )
}
