rule Linux_Shellscript_Downloader : linux malware gafgyt mirai botnet {
    meta:
        description = "Generic Approach to Shellscript downloaders"
        author = "albertzsigovits"
        created_date = "2022-12-09"
        last_updated_date = ""
        version = "0"
        sha256 = "f0d12efb246fac3a93f2cab32924e202eddbe92e7d80ba8be3219f5aadf0551e"
        filetype = "script"
        threat = "Linux.Shellscript.Downloader.A"
    strings:
        $bash = "#!/bin/bash" ascii wide
        $cd1 = "cd /tmp" ascii wide
        $cd2 = "cd /var/run" ascii wide
        $cd3 = "cd /mnt" ascii wide
        $cd4 = "cd /root" ascii wide
        $cmd1 = "wget" ascii wide
        $cmd2 = "curl" ascii wide
        $arch1 = "x86" ascii wide
        $arch2 = "mips" ascii wide
        $arch3 = "arm" ascii wide
        $arch4 = "ppc" ascii wide
    condition:
        uint16(0) == 0x2123
        and $bash
        and 3 of ($cd*)
        and 1 of ($cmd*)
        and 3 of ($arch*)
}
