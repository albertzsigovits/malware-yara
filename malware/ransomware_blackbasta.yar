rule Linux_Ransomware_BlackBasta_Strings : linux esxi ransomware clop cl0p {
    meta:
        author = "albertzsigovits"
        created_date = "2023-02-13"
        last_updated_date = ""
        version = "0"
        filetype = "elf"
        threat = "Linux.Ransomware.BlackBasta.A"
        hash = "8a22d6963d9bdc6a945137281a21f2a037703b73aa463cb3080f8eec71b3762b"
        reference = "https://twitter.com/malwrhunterteam/status/1624478905275977731"
    strings:
        $mutex = "ofijweiuhuewhcsaxs.mutex" ascii wide
        $oni1 = ".6sfv4pnwq" ascii wide
        $oni2 = "5q7kdpzcjzd" ascii wide
        $note = "instructions_read_me.txt" ascii wide
        $arg1 = "-bomb" ascii wide
        $arg2 = "-killservices" ascii wide
        $arg3 = "-forceprivate" ascii wide
        $arg4 = "-forcepath" ascii wide
        $arg5 = "-nomutex" ascii wide
        $arg6 = "-disablewhitelist" ascii wide
        $arg7 = "-file" ascii wide
        $arg8 = "-threads" ascii wide
        $arg9 = "-killesxi" ascii wide
        $str1 = "Your network has been breached and all data was encrypted. Please contact us at:" ascii wide
        $str2 = "*!* To access .onion websites download and install Tor Browser at:" ascii wide
        $str3 = "*!* To restore all your PCs and get your network working again, follow these instructions:" ascii wide
        $str4 = "- Do not modify, rename or delete files. Any attempts to modify, decrypt or rename the files will lead to its fatal corruption." ascii wide
        $str5 = "- Do not hire a recovery company. They can't decrypt without the key." ascii wide
        $str6 = "Waiting you in a chat." ascii wide
    condition:
        uint32(0) == 0x464c457f
        and (
                $mutex
                or
                ($oni1 and $oni2 and $note)
                or
                all of ($arg*)
                or
                4 of ($str*)
        )
}
