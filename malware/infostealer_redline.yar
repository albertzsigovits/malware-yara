rule Infostealer_Redline_AVstrings : windows malware stealer redline {
    meta:
        author = "albertzsigovits"
        created_date = "2023-01-18"
        last_updated_date = ""
        version = "0"
        threat = "Infostealer.Redline.A"
        sha256 = "63a57de472db02a75d91c7cc0d7261d41b0a65eee630896f4bb7a32817c39b12"
    strings:
        $reg1 = "\\Software\\IDAVLAB\\Drweb32w"
        $reg2 = "SOFTWARE\\KasperskyLab\\Components\\101"
        $reg3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\Navw32.exe"
        $reg4 = "SOFTWARE\\Network Associates\\TVD\\VirusScan\\AVConsol\\General"
        $reg5 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{EAAAB119-D0BF-4FF4-B6F0-B6FB0393921A}"
        $reg6 = "SOFTWARE\\Data Fellows\\F-Secure\\Anti-Virus"
        $reg7 = "SOFTWARE\\Sophos\\SweepNT"
        $reg8 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\AVGSE.DLL"
        $reg9 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\vet32.exe"
        $reg10 = "SOFTWARE\\ESet\\NOD\\CurrentVersion\\Info"
        $reg11 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\ClamAV"
        $reg12 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\ashAvast.exe"
        $par1 = "/AL /SS- /SD /SHELL"
        $par2 = "/nostartup"
        $par3 = "/BEEP /NOBOOT"
        $par4 = "/sub /nobootscan /nomemoryscan"
        $par5 = "/scanfile+ /scanboot- /scanmbr-"
        $par6 = "--infected --recursive"
        $vir1 = "F-Secure Anti-Virus"
        $vir2 = "Kaspersky Anti-Virus"
        $vir3 = "Norton AntiVirus"
        $vir4 = "McAfee VirusScan"
        $vir5 = "Sophos Anti-Virus"
        $vir6 = "AVG Anti-Virus"
        $vir7 = "eTrust EZ Antivirus"
        $vir8 = "Jiangmin AntiVirus"
        $vir9 = "NOD32 Antivirus"
        $vir10 = "Clam AntiVirus"
        $vir11 = "avast! Antivirus"
        $vir12 = "Dr.Web"
        $vir13 = "VirusScan"
        $vir14 = "DefScanner"
        $vir15 = "Stop! Scanner"
        $vir16 = "VirusScan"
        $exe1 = "VirusScan.bmp"
        $exe2 = "scanner.exe"
        $exe3 = "fsav.exe"
        $exe4 = "sav32cli.exe"
        $exe5 = "avgscan.exe"
        $exe6 = "nod32.exe"
        $exe7 = "bin\\clamscan.exe"
        $exe8 = "ashQuick.exe"
        $exe9 = "AppID\\KVSrvXP.exe"
        $exe10 = "KVScan.kxp"
    condition:
        uint16(0) == 0x5A4D
        and uint32(uint32(0x3C)) == 0x00004550
        and 50% of ($reg*)
        and 50% of ($exe*)
        and 50% of ($vir*)
        and 50% of ($par*)
}
