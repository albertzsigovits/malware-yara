rule Linux_Ransomware_Clop_Strings : linux esxi ransomware clop cl0p {
    meta:
        author = "albertzsigovits"
        created_date = "2023-02-08"
        last_updated_date = ""
        version = "0"
        filetype = "elf"
        threat = "Linux.Ransomware.Cl0p.A"
        hash = "09d6dab9b70a74f61c41eaa485b37de9a40c86b6d2eae7413db11b4e6a8256ef"
        reference = "https://www.sentinelone.com/labs/cl0p-ransomware-targets-linux-systems-with-flawed-encryption-decryptor-available/"
    strings:
        $email1 = "unlock@support-mult.com" ascii wide
        $email2 = "unlock@rsv-box.com" ascii wide
        $tor1 = "santat7kpllt6iyvqbr7q4amdv6dzrh6paatvyrzl7ry3zm72zigf4ad.onion" ascii wide
        $tor2 = "6v4q5w7di74grj2vtmikzgx2tnq5eagyg2cubpcnqrvvee2ijpmprzqd.onion" ascii wide
        $key = "Jfkdskfku2ir32y7432uroduw8y7318i9018urewfdsZ2Oaifwuieh~~cudsffdsd" ascii wide
        $str1 = "README_C_I_0P.TXT" ascii wide
        $str2 = "CONTACT US BY EMAIL:" ascii wide
        $str3 = "OR WRITE TO THE CHAT AT->" ascii wide
        $str4 = "use TOR browser" ascii wide
        $str5 = "C_I_0P" ascii wide
        $str6 = "-----BEGIN PUBLIC KEY-----" ascii wide
        $str7 = "-----END PUBLIC KEY-----" ascii wide
        $dir1 = "/opt" ascii wide
        $dir2 = "/u01" ascii wide
        $dir3 = "/u02" ascii wide
        $dir4 = "/u03" ascii wide
        $dir5 = "/u04" ascii wide
        $dir6 = "/home" ascii wide
        $dir7 = "/root" ascii wide
    condition:
        uint32(0) == 0x464c457f
        and ( 
                $key
                or
                $email1
                or
                $email2
                or
                $tor1
                or
                $tor2
                or
                (3 of ($str*) and 3 of ($dir*)) 
        )
}
