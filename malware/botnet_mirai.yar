rule Linux_Mirai_Generic : linux malware gafgyt mirai botnet {
    meta:
        description = "Generic Approach to Mirai/Gafgyt samples"
        author = "albertzsigovits"
        created_date = "2022-12-09"
        last_updated_date = ""
        version = "0"
        sha256 = "d47eaac87456ac5929363eee7cffc57540f6130539967dd5cdaf0ddca04e1e94"
        filetype = "elf"
        threat = "Linux.Mirai.Generic.A"
    strings:
        $s1 = "POST /cdn-cgi/" ascii wide // exploit
        $s2 = "HTTP/1.1" ascii wide
        $s3 = "User-Agent:" ascii wide
        $s4 = "Host:" ascii wide
        $s5 = "Cookie:" ascii wide
        $s6 = "http" ascii wide
        $s7 = "url=" ascii wide
        $s8 = "POST" ascii wide
        $s9 = "/proc/net/tcp" ascii wide
    condition:
        uint32(0) == 0x464C457F
        and all of them
}
