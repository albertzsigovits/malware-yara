# PR:
# --------------------------------------------
# https://github.com/VirusTotal/yara/pull/1732
# --------------------------------------------
# VT:
# ----------------------------------------
# vt.metadata.file_type == vt.FileType.LNK
# tag:lnk
# ----------------------------------------

import "lnk"

rule LNK_Test : lnk {
    meta:
        module = "lnk"
        filetype = "lnk"
        author = "albertzsigovits"
        threat = "YARA:LNK"
        description = ""
        url = "https://github.com/albertzsigovits/malware-yara/"
        reference = ""
        sha256 = ""
    condition:
        uint32be(0) == 0x4c000000 // LNK Magic
        and uint32be(4) == 0x01140200 // LNK Header
        and uint32be(0x3C) == 0x07000000 // SW_SHOWMINNOACTIVE
}
